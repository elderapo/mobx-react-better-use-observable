(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{126:function(module,__webpack_exports__,__webpack_require__){"use strict";var MobxProxyEvent,react=__webpack_require__(1),use_force_update=__webpack_require__(320),use_force_update_default=__webpack_require__.n(use_force_update),mobx_module=__webpack_require__(41),DeepProxy=__webpack_require__(683);!function(MobxProxyEvent){MobxProxyEvent.RegisterSubscription="register-subscription",MobxProxyEvent.Write="write"}(MobxProxyEvent||(MobxProxyEvent={}));var MobxProxy_MobxProxy=function(){function MobxProxy(target){this.target=target,this.registeredHandlers=new Map,this.shouldRegisterNewSubscriptions=!0,this.trackedData=new Map,this.observeCleaners=[];var that=this;this.value=new DeepProxy(this.target,{get:function(target,key,receiver){var result=target[key];return that.shouldRegisterNewSubscriptions&&that.trackData({target:target,key:key}),"object"==typeof result&&null!==result?this.nest(result):result}})}return MobxProxy.prototype.on=function(event,handler){this.registeredHandlers.has(event)||this.registeredHandlers.set(event,[]);var thisEventHandlers=this.registeredHandlers.get(event);return thisEventHandlers.push(handler),function(){var index=thisEventHandlers.indexOf(handler);-1!==index&&thisEventHandlers.splice(index,1)}},MobxProxy.prototype.reset=function(){this.shouldRegisterNewSubscriptions=!0,this.trackedData=new Map,this.observeCleaners.forEach((function(fn){return fn()}))},MobxProxy.prototype.dontRegisterNewSubscriptions=function(){this.shouldRegisterNewSubscriptions=!1},MobxProxy.prototype.trackData=function(item){var _this=this;try{Object(mobx_module.b)(item.target)}catch(ex){if(ex.message.includes("[mobx] Cannot obtain atom"))return}if(function(item,key){try{return!!Object(mobx_module.b)(item,key)}catch(ex){return!1}}(item.target,item.key)&&(this.trackedData.has(item.target)||this.trackedData.set(item.target,[]),!this.trackedData.get(item.target).includes(item.key))){var clean=Object(mobx_module.d)(item.target,item.key,(function(change){_this.callHandlers(MobxProxyEvent.Write,[change])}));this.observeCleaners.push(clean),this.trackedData.get(item.target).push(item.key),this.callHandlers(MobxProxyEvent.RegisterSubscription,[item])}},MobxProxy.prototype.callHandlers=function(event,args){this.registeredHandlers.has(event)&&this.registeredHandlers.get(event).forEach((function(fn){fn.apply(void 0,args)}))},MobxProxy}(),useObservable=function(store){var forceUpdate=use_force_update_default()(),proxy=Object(react.useMemo)((function(){return new MobxProxy_MobxProxy(store)}),[store]);proxy.reset();var removeEventListener=proxy.on(MobxProxyEvent.Write,(function(){forceUpdate()}));return Object(react.useEffect)((function(){return proxy.dontRegisterNewSubscriptions(),function(){return removeEventListener()}}),[removeEventListener]),proxy.value};__webpack_require__.d(__webpack_exports__,"a",(function(){return useObservable}))},127:function(module,__webpack_exports__,__webpack_require__){"use strict";var mobx_module=__webpack_require__(41),__decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r},__metadata=function(k,v){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(k,v)},CounterStore_CounterStore=function(){function CounterStore(){this.count=100}return CounterStore.prototype.increment=function(){this.count++},CounterStore.prototype.decrement=function(){this.count--},__decorate([mobx_module.c,__metadata("design:type",Number)],CounterStore.prototype,"count",void 0),__decorate([mobx_module.a.bound,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],CounterStore.prototype,"increment",null),__decorate([mobx_module.a.bound,__metadata("design:type",Function),__metadata("design:paramtypes",[]),__metadata("design:returntype",void 0)],CounterStore.prototype,"decrement",null),CounterStore}(),StoreWithNestedCounter_StoreWithNestedCounter=function StoreWithNestedCounter(){this.a={b:{c:{counterStore:new CounterStore_CounterStore}}}};__webpack_require__.d(__webpack_exports__,"a",(function(){return CounterStore_CounterStore})),__webpack_require__.d(__webpack_exports__,"b",(function(){return StoreWithNestedCounter_StoreWithNestedCounter}))},322:function(module,exports,__webpack_require__){__webpack_require__(323),__webpack_require__(439),module.exports=__webpack_require__(440)},344:function(module,exports){},440:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(125);Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.configure)(__webpack_require__(681),module)}.call(this,__webpack_require__(235)(module))},681:function(module,exports,__webpack_require__){var map={"./stories/useObservable.stories.tsx":682};function webpackContext(req){var id=webpackContextResolve(req);return __webpack_require__(id)}function webpackContextResolve(req){if(!__webpack_require__.o(map,req)){var e=new Error("Cannot find module '"+req+"'");throw e.code="MODULE_NOT_FOUND",e}return map[req]}webpackContext.keys=function webpackContextKeys(){return Object.keys(map)},webpackContext.resolve=webpackContextResolve,module.exports=webpackContext,webpackContext.id=681},682:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),function(module){var _storybook_react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(125),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1),_mobx_react_lite__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(126),_stores__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(127),_use_it_interval__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(321),_storybook_addons__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(40),stories=Object(_storybook_react__WEBPACK_IMPORTED_MODULE_0__.storiesOf)("useObservable",module),counterStore=new _stores__WEBPACK_IMPORTED_MODULE_3__.a;stories.add("Simple",(function(){var observedStore=Object(_mobx_react_lite__WEBPACK_IMPORTED_MODULE_2__.a)(counterStore);return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("h3",null,"Counter: ",observedStore.count),react__WEBPACK_IMPORTED_MODULE_1__.createElement("button",{onClick:observedStore.increment},"increment"),react__WEBPACK_IMPORTED_MODULE_1__.createElement("button",{onClick:observedStore.decrement},"decrement"))}),{notes:{markdown:"This is simple increment/decrement count example. Nothing fancy here."}});var storeWithNestedCounter=new _stores__WEBPACK_IMPORTED_MODULE_3__.b;stories.add("Nested store",(function(){var observedStore=Object(_mobx_react_lite__WEBPACK_IMPORTED_MODULE_2__.a)(storeWithNestedCounter);return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("h3",null,"Counter: ",observedStore.a.b.c.counterStore.count),react__WEBPACK_IMPORTED_MODULE_1__.createElement("button",{onClick:observedStore.a.b.c.counterStore.increment},"increment"),react__WEBPACK_IMPORTED_MODULE_1__.createElement("button",{onClick:observedStore.a.b.c.counterStore.decrement},"decrement"))}),{notes:{markdown:"\nThis example showcases that `useObservable` works well with nested observables. `storeWithNestedCounter` itself is not an observable and doesn't contain any direct observables. It however has instance of `CounterStore` deep down in the tree (`observedStore.a.b.c.counterStore`).\n\nIn daily MobX usage it's common to see the concept of `RootStore`. It's purpose is to hold instances of other stores and connect them with each other. `useObservable` is just perfect for it.\n"}});var autoUpdatableCounterStore=new _stores__WEBPACK_IMPORTED_MODULE_3__.a;stories.add("Conditional observable subscription",(function(){var _a=Object(_storybook_addons__WEBPACK_IMPORTED_MODULE_5__.useState)(!1),isSubscribedToCount=_a[0],setIsSubscribedToCount=_a[1],_b=Object(_storybook_addons__WEBPACK_IMPORTED_MODULE_5__.useState)(100),intervalRate=_b[0],setIntervalRate=_b[1],renderIdRef=Object(_storybook_addons__WEBPACK_IMPORTED_MODULE_5__.useRef)(0);renderIdRef.current++;var observedStore=Object(_mobx_react_lite__WEBPACK_IMPORTED_MODULE_2__.a)(autoUpdatableCounterStore);Object(_use_it_interval__WEBPACK_IMPORTED_MODULE_4__.a)((function(){observedStore.increment(),console.log("Current count value: "+observedStore.count+"!")}),intervalRate);var onCheckCurrentCountValueCallback=Object(_storybook_addons__WEBPACK_IMPORTED_MODULE_5__.useCallback)((function(){alert("Current count value: "+observedStore.count+"!")}),[]);return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("h3",{style:{opacity:isSubscribedToCount?1:.5}},"Counter: ",isSubscribedToCount?observedStore.count:"not subscribed"),react__WEBPACK_IMPORTED_MODULE_1__.createElement("h3",null,"Component rendered ",renderIdRef.current," times!"),react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("span",null,"Increment every"),react__WEBPACK_IMPORTED_MODULE_1__.createElement("input",{style:{margin:"0 10px"},size:1,type:"number",value:intervalRate,onChange:function(e){var parsed=parseInt(e.target.value,10);Number.isNaN(parsed)||setIntervalRate(parsed)}}),react__WEBPACK_IMPORTED_MODULE_1__.createElement("span",null,"miliseconds")),react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,react__WEBPACK_IMPORTED_MODULE_1__.createElement("span",null,"Listen to counter updates:"),react__WEBPACK_IMPORTED_MODULE_1__.createElement("input",{type:"checkbox",style:{textAlign:"center",verticalAlign:"middle",marginLeft:5},checked:isSubscribedToCount,onChange:function(e){return setIsSubscribedToCount(e.target.checked)}})),react__WEBPACK_IMPORTED_MODULE_1__.createElement("button",{onClick:onCheckCurrentCountValueCallback},"Check current count value..."))}),{notes:{markdown:'\nThis example showcases that component gets rerendered only when `observable` gets accessed during `rendering` phase. Access from `useInterval` callback, button `onClick` callback or following ternary operator `isSubscribedToCount ? observedStore.count : "not subscribed"` (when `isSubscribedToCount` is `false`) do not trigger an update!\n'}}),stories.add("empty",(function(){return react__WEBPACK_IMPORTED_MODULE_1__.createElement("div",null,"empty")}))}.call(this,__webpack_require__(235)(module))}},[[322,1,2]]]);
//# sourceMappingURL=main.a9da78445796cf14041d.bundle.js.map